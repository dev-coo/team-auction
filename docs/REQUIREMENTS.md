# 요구사항 명세서

## 1. 문서 정보

| 항목 | 내용 |
|------|------|
| 프로젝트명 | 팀 경매 사이트 |
| 버전 | v1.0 |
| 작성일 | 2025-11-29 |
| 작성자 | 최은우 |

---

## 2. 기능적 요구사항 (Functional Requirements)

### 2.1 경매방 관리 (주최자)

| ID | 기능명 | 설명 | 우선순위 | 상태 |
|----|--------|------|----------|------|
| FR-ROOM-001 | 경매방 생성 | 주최자가 새로운 경매방을 생성 | 높음 | 예정 |
| FR-ROOM-002 | 경매 설정 | 타이틀, 총 포인트, 팀 수, 팀당 인원 등 설정 | 높음 | 예정 |
| FR-ROOM-003 | 초대 링크 생성 | 팀장용/팀원용/옵저버용 초대 링크 생성 | 높음 | 예정 |
| FR-ROOM-004 | 참가자 목록 조회 | 입장한 참가자 목록 및 상태 확인 | 높음 | 예정 |
| FR-ROOM-005 | 참가자 정보 수정 | 미입력 참가자의 정보를 주최자가 직접 수정 | 중간 | 예정 |
| FR-ROOM-006 | 팀장 포인트 지급 | 각 팀장에게 포인트 할당 | 높음 | 예정 |
| FR-ROOM-007 | 경매 시작 | 모든 준비 완료 후 경매 시작 버튼 | 높음 | 예정 |
| FR-ROOM-008 | 경매 진행 제어 | 다음 팀원 경매로 넘기기, 일시정지 등 | 높음 | 예정 |

#### 상세 설명

**FR-ROOM-001: 경매방 생성**
- 설명: 주최자가 새로운 경매를 개설함
- 입력: 경매 타이틀
- 출력: 경매방 생성 완료, 경매방 ID 발급
- 비즈니스 규칙: 주최자 1명당 동시에 1개의 경매방만 운영 가능
- 예외 처리: 필수 입력값 누락 시 에러 메시지

**FR-ROOM-002: 경매 설정**
- 설명: 경매 진행에 필요한 세부 설정
- 입력:
  - 총 포인트 (기본값: 1000)
  - 팀 수 (예: 8팀)
  - 팀당 인원 (예: 5명)
- 고정값:
  - 경매 시작 시간: 15초
  - 입찰 시 추가 시간: +2초
- 출력: 설정 저장 완료
- 비즈니스 규칙: 팀 수 × 팀당 인원 = 총 팀원 수

**FR-ROOM-003: 초대 링크 생성**
- 설명: 역할별 고유 초대 링크 자동 생성 (경매 생성 시)
- 입력: 없음 (경매 생성 시 자동)
- 출력: 역할별 고유 URL
- 비즈니스 규칙:
  - 주최자 링크: 1개 (host_code)
  - 팀장 링크: 팀별 고유 링크 N개 (각 팀의 captain_code)
  - 옵저버 링크: 1개 (observer_code) - 공용, 닉네임 입력 (팀원/관전자 공용)

---

### 2.2 참가자 입장

| ID | 기능명 | 설명 | 우선순위 | 상태 |
|----|--------|------|----------|------|
| FR-JOIN-001 | 팀장 입장 | 팀장 링크로 본인 확인 후 입장 | 높음 | 예정 |
| FR-JOIN-002 | 주최자 입장 | 주최자 링크로 경매방 관리 입장 | 높음 | 예정 |
| FR-JOIN-003 | 옵저버 입장 | 옵저버 공용 링크로 닉네임 입력 후 입장 (팀원/관전자 공용) | 높음 | 예정 |
| FR-JOIN-004 | 대기실 | 경매 시작 전 대기 화면 | 중간 | 예정 |

#### 상세 설명

**FR-JOIN-001: 팀장 입장**
- 설명: 팀장 고유 링크로 접속하여 본인 확인 후 입장
- 입력: 팀장 링크 URL (팀별 고유 captain_code)
- 출력: 주최자가 등록한 본인 정보 표시, "본인 맞음" 확인 버튼
- 비즈니스 규칙:
  - 이미 확인된 팀장은 재입장 시 바로 경매방 이동
  - 링크당 1명의 팀장만 입장 가능
- 예외 처리: 잘못된 링크 시 에러 페이지

**FR-JOIN-002: 주최자 입장**
- 설명: 주최자 링크로 접속하여 경매방 관리 모드 입장
- 입력: 주최자 링크 URL (host_code)
- 출력: 경매방 관리 화면 (참가자 목록, 초대 링크 등)
- 비즈니스 규칙:
  - 주최자는 참가자(participants)에 등록되지 않음
  - 경매 진행 제어 권한만 보유

**FR-JOIN-003: 옵저버 입장**
- 설명: 옵저버 공용 링크로 접속하여 관전 모드 입장 (팀원/관전자 공용)
- 입력: 옵저버 링크 URL (observer_code), 닉네임
- 출력: 닉네임 입력 폼, 입력 후 경매방 이동
- 비즈니스 규칙:
  - 닉네임만 입력하면 즉시 입장 가능
  - 옵저버는 관전 및 채팅만 가능
  - 팀원(경매 대상)도 본인 경매를 관전하려면 옵저버로 입장

---

### 2.3 실시간 경매

#### 경매 페이즈 흐름
```
[대기] → [팀장 소개] → [팀원 셔플] → [경매 진행] → [종료]
```

| ID | 기능명 | 설명 | 우선순위 | 상태 |
|----|--------|------|----------|------|
| FR-AUC-000 | 페이즈 표시 | 현재 페이즈를 상단에 표시하여 모든 참가자가 확인 가능 | 높음 | 예정 |
| FR-AUC-001 | 대기 페이즈 | 팀장 입장 대기, 모두 입장 시 주최자가 진행 가능 | 높음 | 예정 |
| FR-AUC-002 | 팀장 소개 페이즈 | 주최자가 팀장들을 소개하는 시간 | 중간 | 예정 |
| FR-AUC-003 | 팀원 셔플 페이즈 | 경매 대상 팀원 순서 무작위 배치 (애니메이션) | 높음 | 예정 |
| FR-AUC-004 | 경매 진행 페이즈 | 팀원 1명씩 하이라이트하며 순차 경매 | 높음 | 예정 |
| FR-AUC-005 | 최소단위 입찰 | 현재가 + 최소 단위로 입찰 | 높음 | 예정 |
| FR-AUC-006 | 직접입력 입찰 | 원하는 금액 직접 입력하여 입찰 | 높음 | 예정 |
| FR-AUC-007 | 타이머 | 15초 시작, 입찰 시 +2초 | 높음 | 예정 |
| FR-AUC-008 | 낙찰 처리 | 타이머 종료 시 최고 입찰자에게 낙찰 | 높음 | 예정 |
| FR-AUC-009 | 포인트 차감 | 낙찰 시 해당 팀장 포인트에서 차감 | 높음 | 예정 |
| FR-AUC-010 | 팀 구성 현황 | 각 팀의 현재 멤버 구성 실시간 표시 | 높음 | 예정 |
| FR-AUC-011 | 잔여 포인트 표시 | 각 팀장의 남은 포인트 실시간 표시 | 높음 | 예정 |

#### 상세 설명

**FR-AUC-000: 페이즈 표시**
- 설명: 화면 상단에 현재 진행 중인 페이즈를 표시
- 입력: 없음 (자동)
- 출력: 페이즈명 표시 (예: "🔴 대기 중", "📢 팀장 소개", "🎲 팀원 셔플", "⚡ 경매 진행 중")
- 비즈니스 규칙: 모든 참가자(주최자, 팀장, 옵저버)가 동일한 페이즈 상태 확인 가능

**FR-AUC-001: 대기 페이즈**
- 설명: 경매 시작 전 참가자 입장을 기다리는 단계
- 입력: 참가자 입장 이벤트
- 출력:
  - 입장한 참가자 목록 실시간 갱신
  - 팀장 입장 현황 표시 (예: "팀장 5/8 입장")
- 비즈니스 규칙:
  - 모든 팀장이 입장해야 [진행] 버튼 활성화
  - 팀원은 일부만 입장해도 진행 가능
- 주최자 액션: [진행] 버튼 → 팀장 소개 페이즈로 이동

**FR-AUC-002: 팀장 소개 페이즈**
- 설명: 주최자가 각 팀장을 소개하는 시간
- 입력: 없음 (주최자가 말로 진행)
- 출력:
  - 팀장 목록 및 프로필 화면에 표시
  - 각 팀장의 닉네임, 포지션, 한줄소개 표시
- 비즈니스 규칙:
  - 시간 제한 없음
  - 주최자가 언제든지 다음으로 진행 가능
- 주최자 액션: [진행] 버튼 → 팀원 셔플 페이즈로 이동

**FR-AUC-003: 팀원 셔플 페이즈**
- 설명: 경매 대상 팀원의 순서를 무작위로 섞어서 배치
- 입력: [진행] 버튼 클릭 시 자동 시작
- 출력:
  - 셔플 애니메이션 (필수) - 카드가 섞이는 듯한 시각적 효과
  - 최종 순서 목록 표시
- 비즈니스 규칙:
  - 애니메이션 완료 후 [진행] 버튼 활성화
  - 모든 참가자가 동일한 순서 확인
- 주최자 액션: [진행] 버튼 → 경매 진행 페이즈로 이동

**FR-AUC-004: 경매 진행 페이즈**
- 설명: 셔플된 순서대로 팀원 1명씩 경매 진행
- 입력: 각 팀원 경매 시작
- 출력:
  - 현재 경매 대상 팀원 하이라이트
  - 해당 팀원 프로필 (닉네임, 포지션, 한줄평) 크게 표시
  - 현재 입찰가, 최고 입찰 팀장, 타이머 표시
- 비즈니스 규칙:
  - 낙찰 완료 시 자동으로 다음 팀원으로 이동
  - 모든 팀원 경매 완료 시 종료 페이즈로 이동

**FR-AUC-005: 최소단위 입찰**
- 설명: 버튼 클릭으로 최소 단위만큼 입찰
- 입력: 입찰 버튼 클릭
- 출력: 입찰가 갱신, 타이머 +2초
- 비즈니스 규칙:
  - 현재가 0~99: +5 포인트
  - 현재가 100~199: +10 포인트
  - 현재가 200~299: +15 포인트
  - 현재가 300~399: +20 포인트
  - 이후 100 단위마다 +5씩 증가
- 예외 처리: 잔여 포인트 부족 시 입찰 불가

**FR-AUC-006: 타이머**
- 설명: 경매 제한 시간 관리
- 입력: 없음 (자동)
- 출력: 실시간 타이머 표시
- 비즈니스 규칙:
  - 초기값: 15초
  - 입찰 발생 시: 현재 남은 시간 + 2초
  - 0초 도달 시: 낙찰 처리
- 예외 처리: 입찰자가 없을 경우 유찰 처리 (주최자 결정)

**FR-AUC-007: 낙찰 처리**
- 설명: 타이머 종료 시 최고 입찰자에게 팀원 배정
- 입력: 타이머 0초 도달
- 출력:
  - 낙찰 알림 (전체)
  - 팀원 → 해당 팀 배정
  - 팀 채팅방에 팀원 추가
- 비즈니스 규칙: 동시 입찰 시 서버 도착 순서 기준

---

### 2.4 실시간 채팅

| ID | 기능명 | 설명 | 우선순위 | 상태 |
|----|--------|------|----------|------|
| FR-CHAT-001 | 전체 채팅 | 모든 참가자(주최자, 팀장, 팀원)가 참여하는 채팅 | 높음 | 예정 |
| FR-CHAT-002 | 채팅 알림 | 새 메시지 알림 | 낮음 | 예정 |

#### 상세 설명

**FR-CHAT-001: 전체 채팅**
- 설명: 경매방 내 모든 참가자가 참여하는 실시간 채팅
- 입력: 메시지 내용
- 출력: 모든 참가자에게 메시지 전송
- 비즈니스 규칙:
  - 주최자, 팀장, 옵저버 모두 참여 가능
  - 팀 채팅은 제공하지 않음

---

### 2.5 경매 결과

| ID | 기능명 | 설명 | 우선순위 | 상태 |
|----|--------|------|----------|------|
| FR-RESULT-001 | 결과 페이지 | 최종 팀 구성 결과 표시 | 중간 | 예정 |
| FR-RESULT-002 | 결과 공유 | 결과 페이지 URL 공유 | 중간 | 예정 |
| FR-RESULT-003 | 대진표 생성 | 팀 대진표 자동/수동 생성 | 낮음 | 예정 |
| FR-RESULT-004 | 결과 내보내기 | 이미지 또는 텍스트로 내보내기 | 낮음 | 예정 |

---

## 3. 비기능적 요구사항 (Non-Functional Requirements)

### 3.1 성능 요구사항

| ID | 항목 | 요구사항 | 측정 기준 |
|----|------|----------|-----------|
| NFR-PERF-001 | 페이지 로딩 속도 | 3초 이내 | Core Web Vitals |
| NFR-PERF-002 | 동시 접속자 | 최소 50명 이상 | 1개 경매방 기준 |
| NFR-PERF-003 | 실시간 통신 지연 | 500ms 이내 | WebSocket 메시지 |
| NFR-PERF-004 | 입찰 처리 시간 | 100ms 이내 | 서버 응답 시간 |

### 3.2 보안 요구사항

| ID | 항목 | 요구사항 |
|----|------|----------|
| NFR-SEC-001 | HTTPS | SSL/TLS 적용 필수 |
| NFR-SEC-002 | 링크 보안 | 초대 링크 추측 불가능한 형태 (UUID 등) |
| NFR-SEC-003 | XSS 방지 | 채팅 입력값 검증 및 이스케이프 |
| NFR-SEC-004 | 입찰 무결성 | 입찰 데이터 위변조 방지 |

### 3.3 확장성 요구사항

| ID | 항목 | 요구사항 |
|----|------|----------|
| NFR-SCA-001 | 다중 경매방 | 동시에 여러 경매방 운영 가능 |
| NFR-SCA-002 | 게임 확장 | 롤 외 다른 게임 지원 고려 (추후) |

### 3.4 가용성 요구사항

| ID | 항목 | 요구사항 |
|----|------|----------|
| NFR-AVL-001 | 서비스 가용률 | 경매 진행 중 99% 이상 |
| NFR-AVL-002 | 장애 복구 | 경매 데이터 실시간 백업 |

### 3.5 호환성 요구사항

| ID | 항목 | 요구사항 |
|----|------|----------|
| NFR-CMP-001 | 브라우저 | Chrome, Safari, Firefox, Edge 최신 2개 버전 |
| NFR-CMP-002 | 디바이스 | 반응형 웹 (Desktop, Tablet, Mobile) |
| NFR-CMP-003 | 최소 해상도 | 360px ~ 1920px |

---

## 4. 화면 요구사항

### 4.1 화면 목록

| ID | 화면명 | 설명 | 접근 권한 |
|----|--------|------|-----------|
| SCR-001 | 랜딩 페이지 | 서비스 소개, 경매 생성 버튼 | 전체 |
| SCR-002 | 경매 생성 페이지 | 경매 설정 폼 | 주최자 |
| SCR-003 | 경매 관리 페이지 | 참가자 관리, 초대 링크 | 주최자 |
| SCR-004 | 입장 페이지 | 역할별 정보 입력 폼 | 링크 보유자 |
| SCR-005 | 대기실 | 경매 시작 전 대기 | 참가자 전체 |
| SCR-006 | 경매 진행 페이지 | 실시간 경매 화면 | 참가자 전체 |
| SCR-007 | 결과 페이지 | 최종 팀 구성 | 전체 |

### 4.2 화면 흐름도

```
[주최자 플로우]
랜딩 페이지
    └── 경매 생성 페이지 (팀장/팀원 정보 등록)
            └── 생성 완료 모달 (초대 링크 표시)
                    └── 경매방 (참가자 확인, 경매 제어)
                            └── 결과 페이지

[팀장 플로우]
팀장 개별 링크
    └── 입장 페이지 (본인 정보 확인)
            └── 경매방 (입찰)
                    └── 결과 페이지

[옵저버 플로우] (팀원/관전자 공용)
옵저버 공용 링크
    └── 입장 페이지 (닉네임 입력)
            └── 경매방 (관전/채팅)
                    └── 결과 페이지

> 참고: 팀원(경매 대상)도 본인 경매를 관전하려면 옵저버로 입장
```

### 4.3 주요 화면 레이아웃

#### SCR-006: 경매 진행 페이지 (추후 재수정)

```
┌──────────────────────────────────────────────────────────────────────────────┐
│  [🎮 롤 내전 경매]                                    [⚡ 경매 진행 중] 3/32  │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                        │ │
│  │                     🎯 현재 경매 대상                                   │ │
│  │                                                                        │ │
│  │         ┌─────────┐                                                    │ │
│  │         │  아바타  │    닉네임: 페이커짱                                │ │
│  │         │   👤    │    포지션: 미드                                    │ │
│  │         └─────────┘    한줄평: "미드 장인입니다 믿고 뽑아주세요"        │ │
│  │                                                                        │ │
│  │  ┌──────────────────────────────────────────────────────────────────┐ │ │
│  │  │ ⏱️ 12초                                                          │ │ │
│  │  │ ████████████████████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ │ │ │
│  │  └──────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                        │ │
│  │         💰 현재 입찰가: 150 포인트                                     │ │
│  │         👑 최고 입찰자: A팀 (팀장A)                                    │ │
│  │                                                                        │ │
│  │         ┌─────────────┐  ┌─────────────────────────┐                  │ │
│  │         │  +10 입찰   │  │  직접 입력: [    ] 입찰  │                  │ │
│  │         └─────────────┘  └─────────────────────────┘                  │ │
│  │                                                                        │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
├─────────────────────────────────┬────────────────────────────────────────────┤
│      📋 팀별 현황 (5팀)         │         💬 채팅                            │
│  ┌───────────────────────────┐ │  ┌────────────────────────────────────────┐│
│  │ 🔴 A팀        잔여: 500p  │ │  │ [전체] [A팀] [B팀] [C팀] [D팀] [E팀]   ││
│  │    팀장A (미드)           │ │  │                                        ││
│  │    ├ 팀원1 (원딜)         │ │  │ ─────────────────────────────────────  ││
│  │    └ 팀원2 (서폿)         │ │  │                                        ││
│  ├───────────────────────────┤ │  │ [팀장A] 이번엔 내가 간다               ││
│  │ 🟠 B팀        잔여: 350p  │ │  │ [팀장B] ㅋㅋㅋ 경쟁 치열하네           ││
│  │    팀장B (정글)           │ │  │ [유저1] 와 불꽃 경쟁                   ││
│  │    └ 팀원3 (탑)           │ │  │ [팀장C] 포기 안해                      ││
│  ├───────────────────────────┤ │  │ [유저2] 페이커짱 화이팅!               ││
│  │ 🟡 C팀        잔여: 420p  │ │  │                                        ││
│  │    팀장C (원딜)           │ │  │                                        ││
│  │    (팀원 없음)            │ │  │                                        ││
│  ├───────────────────────────┤ │  │                                        ││
│  │ 🟢 D팀        잔여: 280p  │ │  │                                        ││
│  │    팀장D (서폿)           │ │  │                                        ││
│  │    ├ 팀원4 (미드)         │ │  │                                        ││
│  │    └ 팀원5 (정글)         │ │  ├────────────────────────────────────────┤│
│  ├───────────────────────────┤ │  │ 메시지 입력...                  [전송] ││
│  │ 🔵 E팀        잔여: 600p  │ │  └────────────────────────────────────────┘│
│  │    팀장E (탑)             │ │                                            │
│  │    (팀원 없음)            │ │                                            │
│  └───────────────────────────┘ │                                            │
├─────────────────────────────────┴────────────────────────────────────────────┤
│  📜 다음 경매 대기: 팀원6, 팀원7, 팀원8, 팀원9, 팀원10 ... (+22명)           │
└──────────────────────────────────────────────────────────────────────────────┘
```

#### 타이머 바 상세
```
[입찰 직후 - 시간 추가됨]
⏱️ 12초 ████████████████████████████████████████░░░░░░░░░░░░░░░░░░░░ (80%)

[시간 경과 중]
⏱️ 7초  ████████████████████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ (47%)

[마감 임박 - 빨간색 깜빡임]
⏱️ 3초  🔴██████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ (20%)
```

---

## 5. 데이터 요구사항

### 5.1 주요 데이터 엔티티

| 엔티티 | 설명 | 주요 속성 |
|--------|------|-----------|
| AuctionRoom | 경매방 정보 | id, title, totalPoints, teamCount, memberPerTeam, status, createdAt |
| Participant | 참가자 정보 | id, roomId, nickname, role, position, description, teamId |
| Team | 팀 정보 | id, roomId, captainId, currentPoints, members[] |
| Bid | 입찰 기록 | id, roomId, participantId, teamId, targetId, amount, createdAt |
| ChatMessage | 채팅 메시지 | id, roomId, senderId, channelType, content, createdAt |
| AuctionResult | 경매 결과 | id, roomId, targetId, winnerTeamId, finalPrice |

### 5.2 엔티티 관계도 (ERD 개요)

```
AuctionRoom (1) ─────< (N) Participant
     │
     │ (1)
     │
     └────< (N) Team ─────< (N) Participant (as member)
     │            │
     │            └────< (N) Bid
     │
     └────< (N) ChatMessage
     │
     └────< (N) AuctionResult
```

### 5.3 데이터 보존 정책

| 데이터 유형 | 보존 기간 | 비고 |
|-------------|-----------|------|
| 경매방 데이터 | 경매 종료 후 7일 | 결과 조회 가능 |
| 채팅 데이터 | 경매 종료 후 1일 | 이후 자동 삭제 |
| 입찰 로그 | 경매 종료 후 7일 | 분쟁 해결용 |

---

## 6. 외부 연동 요구사항

| ID | 연동 대상 | 용도 | 연동 방식 | 우선순위 |
|----|-----------|------|-----------|----------|
| EXT-001 | - | - | - | - |

> 현재 버전에서는 외부 연동 없음. 추후 Riot API 연동 고려.

---

## 7. 요구사항 우선순위 요약

### Must Have (필수) - MVP
- [x] 경매방 생성 및 설정 (FR-ROOM-001~003)
- [x] 팀장/팀원 사전 등록 (생성 시)
- [x] 초대 링크로 입장: 팀장 본인 확인, 옵저버 닉네임 입력 (FR-JOIN-001~003)
- [x] 실시간 경매 진행 (FR-AUC-003~008)
- [x] 실시간 채팅 - 전체 (FR-CHAT-001)
- [x] 경매 결과 페이지 (FR-RESULT-001)

### Should Have (권장) - v1.0
- [ ] 팀장 소개 페이즈 (FR-AUC-001)
- [ ] 참가자 정보 수정 - 주최자 (FR-ROOM-005)
- [ ] 결과 공유 (FR-RESULT-002)
- [ ] 경매 현황 대시보드 (FR-AUC-009~010)

### Could Have (선택) - v1.x
- [ ] 대진표 생성 (FR-RESULT-003)
- [ ] 결과 내보내기 (FR-RESULT-004)
- [ ] 채팅 알림 (FR-CHAT-002)

### Won't Have (제외) - 현재 버전
- [ ] 회원가입/로그인 시스템
- [ ] 게임 API 연동 (Riot API)
- [ ] 결제/유료화 기능
- [ ] 모바일 앱
- [ ] 팀 채팅 (추후 고려)

---

## 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|-----------|
| v1.0 | 2025-11-29 | 최은우 | 최초 작성 |
